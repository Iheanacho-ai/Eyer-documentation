---
sidebar_position: 2
---

# Agent - Install option 1 

> **_NOTE:_** This is the default installation setup. In this setup you deploy a Jolokia agent per Atom host and then have a single Telegraf agent deployed to a seperate instance.


The Eyer for Boomi connector setup requires you to download these two components:
* [Influx Telegraf open source data collector](https://www.influxdata.com/downloads/)
* [Jolokia JVM-Agent](https://jolokia.org/download.html)


## Exposing JMX ports on your Atom

Log in to your [Boomi AtomSphere account](https://platform.boomi.com/) and select your Atom. Navigate to the **Properties -> Advanced** tab to add and expose the following JMX ports on your Atom:


* JMX Remote Port ( 5002 )
* JMX Remote RMI Port ( 5002 )
* JMX Remote SSL ( disabled )
* JMX Remote Authentication ( disabled )

Each of your Atoms should look like this when you are done.




![install](./img/install.png)


Restart your Atom to see the changes.


## Downloading Jolokia

After setting up and configuring your Boomi Atom, the next step is to download and set up Jolokia to expose Java Management Extension (JMX) metrics from the Boomi Atom.

To configure your Jolokia agent, repeat the following processes for each Atom you’d like to monitor:



1. Install a [Java Development Kit (JDK)](https://www.oracle.com/ng/java/technologies/downloads/) on your Atoms server, as Jolokia requires the tools.jar file.
2. Next, find the process ID (PID) of your Atom using these commands:

    **For Windows users**: Use the tasklist command in Command Prompt (CMD) to find the PID of the `atom.exe` process. Then take the PID from the `atom.exe` process with the highest memory usage.


        ```
            tasklist /FI "IMAGENAME eq atom.exe"
        ```



    **For Linux users**: Linux allows us to use a combination of commands to find your Atom's process ID (PID). 
    
     First, use `ps` to list all running processes. Then, pipe this output to `grep` to filter for entries matching the username ($USER) and the process name "atom". Finally, you use the `awk` command to extract just the PID from the filtered results.

        ```
            ps aux | grep ${USER} | grep "atom" | grep -v grep | awk '{ print $2 }'
        ```





3. Once you have the PID of the Atom process, start your Jolokia agent with this command. Remember to replace the `jolokia-instance`, `ATOM_PID`, and `server_ip` placeholders with the appropriate values:
    - jolokia-instance -> path to your downloaded Jolokia JVM agent
    - ATOM PID -> the process ID of your Boomi atom
    - server_ip -> the IP address of your Boomi atom


    ```
        java -jar jolokia-instance  Atom_PID --host= server_ip 
    ```



5. Check if Jolokia is running effectively by running this command:

    ```
    curl http://YOUR_HOSTNAME:8778/jolokia/version
    ```



6. Next, in your local Boomi Atom folder, navigate to the `bin` directory and open up the `restart` Windows powershell file. 

    In this file, locate the `Restart-Service -Verbose $srvName` section and add the following lines of code.

    Be sure to replace, the `jolokia-instance` with the path to your newly downloaded Jolokia JVM agent, and the `ip_address` in `host=ip_address` with your Jolokia agent IP address.

	```
	$atoms = Get-Process atom | Where-Object {$_.Handles -gt 200} | select -expand id
    Start-Process java -ArgumentList ‘-jar’, ‘jolokia-instance --host=ip_address’, $atoms
	```

	The code lines above guarantee that when your Boomi Atom restarts and its PID changes, your Jolokia agent will still be able to re-attach itself to the correct process ID

    Your Restart-Service section should look like this:

	```
    Restart-Service -Verbose $srvName
    Start-Sleep -s 5
    for($i=1; $i -le 5; $i++) {
        $serviceAfter = Get-Service $srvName
        if ($serviceAfter.status -eq “running”) {
            “$srvName is Running”
        
        $atoms = Get-Process atom | Where-Object {$_.Handles -gt 200} | select -expand id
        Start-Process java -ArgumentList ‘-jar’, ‘jolokia_instance --host=ip_address’, $atoms
        
            break
        }

        Start-Sleep -s 20
        Start-Service -Verbose $srvName 

    }

	```


## Installing Telegraf 

Telegraf is an open-source agent that collects metrics from your applications. To run your Telegraf as a service, you need to download the [eyer_telegraf.conf](./conf-file/eyer_telegraf.conf) file.

Next, rename the provided `eyer_telegraf.conf` file to `telegraf.conf`. This new file will replace the original `telegraf.conf` file in your Influx Telegraf folder. Then, proceed to make the following edits to the telegraf.conf file:



1. **Enable authentication using your Eyer agent API token:** In the `[outputs.http.headers]` section, locate the authenticate field and replace its value with your Eyer agent API token
2. **Enable Jolokia connection**: In the `# # Read JMX metrics from a Jolokia REST agent endpoint` section, make the following changes:
    * Duplicate the `[[inputs.jolokia2_agent]]` section, along with all metrics, for each Atom you wish to monitor. If you're monitoring only one Atom, skip this step.

    * Next, edit each of the URLs to reflect your Jolokia IP address. Replace the `x.x.x.x` path in the URL with your `jolokia` IP address.

        ```
        # # Read JMX metrics from a Jolokia REST agent endpoint
        [[inputs.jolokia2_agent]]
        urls = ["http://x.x.x.x:8778/jolokia"]

        ```


	If you monitor a single atom and your Telegraf and Jolokia agents are hosted in the same location, use this URL:


    ```
    urls = ["http://localhost:8778/jolokia"]
    ```  



3. Save the changes made to the `telegraf.conf` file.


4. Once you’ve made your changes to the `telegraf.conf` file, change your current directory to the Telegraf folder containing the `telegraf.exe`, and the `telegraf.conf` files.

    Then register and start your Telegraf agent as a service with the following commands for your operating system.


    * For Windows users, start your Telegraf agent with this command.

        ```
        .\telegraf.exe --service install --config telegraf.conf
        .\telegraf.exe --service start
        ```



    * For Linux users, start your Telegraf agent with this command:

        ```
        sudo systemctl start telegraf

        ```

    For other operating systems not listed here, check out the [official Telegraf documentation](https://docs.influxdata.com/telegraf/v1/install/).